@startuml sequence
title TalkUML 專案工作流程（Sequence）

autonumber

actor User
participant "OpenCode Agent\n(talkuml-skill enabled)" as Agent
participant "diagrams/" as Diagrams
participant "talkuml-dev\n(tmux session)" as Dev
participant "talkuml-watch\n(entr)" as Watch
participant "plantuml" as PlantUML
participant "output/" as Output
participant "talkuml-preview\n(inotifywait)" as Preview
participant "imv" as Imv

User -> Dev : just dev
Dev -> Watch : start (left pane)
Dev -> Preview : start (right pane)

User -> Agent : 描述想要的圖表
Agent -> Diagrams : write <name>.puml
User -> Diagrams : save file

Watch -> Diagrams : detect change
Watch -> PlantUML : compile changed .puml
PlantUML -> Output : write <name>.png

Preview -> Diagrams : observe create/modify/moved_to
Preview -> Imv : imv-msg open output/<name>.png
Preview -> Imv : imv-msg goto -1
Imv --> User : display latest image

@enduml
